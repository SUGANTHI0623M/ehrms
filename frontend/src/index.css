@tailwind base;
@tailwind components;
@tailwind utilities;

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
*/

@layer base {
  :root {
    --background: 210 20% 98%;
    --foreground: 222.2 47% 11%;

    --card: 0 0% 100%;
    --card-foreground: 222.2 47% 11%;

    --popover: 0 0% 100%;
    --popover-foreground: 222.2 47% 11%;

    --primary: 142 70% 38%;
    --primary-foreground: 0 0% 100%;

    --secondary: 210 40% 96%;
    --secondary-foreground: 222.2 47% 11%;

    --muted: 210 40% 96%;
    --muted-foreground: 215 16% 47%;

    --accent: 142 70% 73%;
    --accent-foreground: 0 0% 0%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    --border: 214 32% 91%;
    --input: 214 32% 91%;
    --ring: 142 70% 38%;

    --radius: 0.75rem;

    /* LMS: standard readable typography */
    --lms-font-sans: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    --lms-text-xs: 0.75rem;
    --lms-text-sm: 0.875rem;
    --lms-text-base: 1rem;
    --lms-text-lg: 1.125rem;
    --lms-leading: 1.5;

    --success: 142 76% 36%;
    --success-foreground: 0 0% 100%;

    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 100%;

    --info: 199 89% 48%;
    --info-foreground: 0 0% 100%;

    --sidebar-background: 0 0% 100%;
    --sidebar-foreground: 0 0% 0%;
    --sidebar-primary: 0 0% 100%;
    --sidebar-primary-foreground: 217 91% 60%;
    --sidebar-accent: 142 70% 38%;
    --sidebar-accent-foreground: 0 0% 100%;
    --sidebar-primary: 0 0% 100%;
    --sidebar-ring: 0 0% 100%;
    --sidebar-border: 142 70% 38%;
  }

  .dark {
    --background: 222 47% 11%;
    --foreground: 210 40% 98%;

    --card: 217 33% 17%;
    --card-foreground: 210 40% 98%;

    --popover: 217 33% 17%;
    --popover-foreground: 210 40% 98%;

    --primary: 142 70% 38%;
    --primary-foreground: 0 0% 100%;

    --secondary: 217 33% 17%;
    --secondary-foreground: 210 40% 98%;

    --muted: 217 33% 17%;
    --muted-foreground: 215 20% 65%;

    --accent: 173 80% 40%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 63% 31%;
    --destructive-foreground: 210 40% 98%;

    --border: 217 33% 17%;
    --input: 217 33% 17%;
    --ring: 142 70% 38%;

    --success: 142 76% 36%;
    --success-foreground: 0 0% 100%;

    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 100%;

    --info: 199 89% 48%;
    --info-foreground: 0 0% 100%;

    --sidebar-background: 0 0% 100%;
    --sidebar-foreground: 0 0% 0%;
    --sidebar-primary: 0 0% 100%;
    --sidebar-primary-foreground: 217 91% 60%;
    --sidebar-accent: 217 91% 65%;
    --sidebar-accent-foreground: 0 0% 100%;
    --sidebar-primary: 142 70% 38%;
    --sidebar-ring: 0 0% 100%;
    --sidebar-border: 142 70% 38%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-size: 16px; /* Readable on mobile; prevents iOS zoom on input focus */
  }
  @media (min-width: 640px) {
    body { font-size: 16px; }
  }

  /* Respect reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {

    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
}

@layer utilities {

  /* Responsive utilities */
  .touch-manipulation {
    touch-action: manipulation;
  }

  /* Ensure minimum touch target size (44x44px recommended) */
  .touch-target {
    min-height: 44px;
    min-width: 44px;
  }

  /* Full-screen modals on mobile (use class on Modal wrapper or content) */
  @media (max-width: 640px) {
    .ant-modal-wrap .ant-modal {
      max-width: 100vw !important;
      top: 0 !important;
      padding-bottom: 0 !important;
    }
    .ant-modal-wrap .ant-modal-content {
      border-radius: 0;
      max-height: 100vh;
      overflow: auto;
    }
    .ant-modal-wrap .ant-modal-body {
      padding: 1rem;
    }
  }

  /* Responsive text utilities */
  .text-responsive-xs {
    @apply text-xs sm:text-sm;
  }

  .text-responsive-sm {
    @apply text-sm sm:text-base;
  }

  .text-responsive-base {
    @apply text-base sm:text-lg;
  }

  .text-responsive-lg {
    @apply text-lg sm:text-xl;
  }

  .text-responsive-xl {
    @apply text-xl sm:text-2xl;
  }

  /* Responsive spacing */
  .p-responsive {
    @apply p-3 sm:p-4 md:p-6;
  }

  .px-responsive {
    @apply px-3 sm:px-4 md:px-6;
  }

  .py-responsive {
    @apply py-3 sm:py-4 md:py-6;
  }

  /* Responsive container */
  .container-responsive {
    @apply w-full max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8;
  }

  /* Mobile-first table wrapper */
  .table-wrapper {
    @apply overflow-x-auto -mx-3 sm:mx-0;
  }

  .table-wrapper table {
    @apply min-w-full;
  }

  /* Page transition utilities */
  .page-enter {
    animation: fade-in 0.2s ease-in-out, slide-in-from-right 0.25s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .page-exit {
    animation: fade-out 0.15s ease-in-out, slide-out-to-left 0.2s ease-in;
  }

  /* Card hover effects */
  .card-hover {
    @apply transition-all duration-200 ease-in-out;
  }

  .card-hover:hover {
    @apply shadow-md translate-y-[-2px];
  }

  /* Button micro-interactions */
  .btn-interactive {
    @apply transition-all duration-150 ease-in-out;
  }

  .btn-interactive:active {
    @apply scale-[0.98];
  }

  /* Input focus animations */
  .input-focus {
    @apply transition-all duration-200 ease-in-out;
  }

  .input-focus:focus-visible {
    @apply ring-2 ring-ring ring-offset-2 shadow-sm;
  }

  /* Row entry animation */
  .row-enter {
    animation: fade-up 0.3s cubic-bezier(0.16, 1, 0.3, 1) backwards;
  }

  /* Stagger delay utilities */
  .stagger-1 {
    animation-delay: 0.05s;
  }

  .stagger-2 {
    animation-delay: 0.1s;
  }

  .stagger-3 {
    animation-delay: 0.15s;
  }

  .stagger-4 {
    animation-delay: 0.2s;
  }

  .stagger-5 {
    animation-delay: 0.25s;
  }

  /* Shimmer effect for skeleton */
  @keyframes shimmer {
    0% {
      background-position: -1000px 0;
    }

    100% {
      background-position: 1000px 0;
    }
  }

  .animate-shimmer {
    animation: shimmer 2s linear infinite;
    background: linear-gradient(90deg,
        transparent 0%,
        rgba(255, 255, 255, 0.1) 50%,
        transparent 100%);
    background-size: 1000px 100%;
  }

  /* LMS expandable table – unified Live Sessions & Assessment Management */
  .lms-expandable-table .ant-table-thead > tr > th {
    background: hsl(var(--muted)) !important;
    font-weight: 600;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.025em;
    color: hsl(var(--muted-foreground));
  }
  .lms-expandable-table .ant-table-tbody > tr:hover > td {
    background: hsl(var(--muted) / 0.5) !important;
  }
  .lms-expandable-table .ant-table-tbody > tr.ant-table-row-expanded > td {
    padding: 0 !important;
    border-bottom: none !important;
  }
  .lms-expandable-table .ant-table-cell .ant-table-expand-icon-col {
    width: 48px;
  }

  /* LMS module: standard typography and responsive layout */
  .lms-page,
  .lms-module {
    font-family: var(--lms-font-sans);
    font-size: var(--lms-text-sm);
    line-height: var(--lms-leading);
    -webkit-font-smoothing: antialiased;
  }
  .lms-page {
    width: 100%;
    max-width: 100%;
    overflow-x: hidden;
    box-sizing: border-box;
  }
  @media (min-width: 768px) {
    .lms-page { font-size: var(--lms-text-base); }
  }
  .lms-page .ant-typography,
  .lms-page .ant-card,
  .lms-page .ant-btn,
  .lms-page .ant-tag,
  .lms-page .ant-input,
  .lms-page .ant-select-selector {
    font-family: var(--lms-font-sans);
  }
  .lms-page h1, .lms-page h2, .lms-page h3, .lms-page .ant-typography h1, .lms-page .ant-typography h2, .lms-page .ant-typography h3 {
    font-family: var(--lms-font-sans);
    font-weight: 600;
    letter-spacing: -0.01em;
  }
  .lms-page .ant-table-wrapper {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    width: 100%;
  }
  /* Global table standards: min padding, font sizes, row height, touch-friendly */
  .lms-page .ant-table-thead > tr > th {
    font-size: 14px;
    padding: 8px 16px;
    min-height: 48px;
  }
  .lms-page .ant-table-tbody > tr > td {
    font-size: 13px;
    padding: 8px 16px;
    min-height: 48px;
  }
  .lms-page .ant-table-tbody .ant-btn,
  .lms-page .ant-table-tbody .ant-input {
    min-height: 44px;
  }
  .scores-table-wrapper {
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    margin-bottom: 16px;
  }
  .scores-table-wrapper .ant-table {
    min-width: 800px;
  }
  .scores-course-table.ant-table .ant-table-thead > tr > th,
  .scores-course-table.ant-table .ant-table-tbody > tr > td,
  .scores-department-table.ant-table .ant-table-thead > tr > th,
  .scores-department-table.ant-table .ant-table-tbody > tr > td {
    padding: 12px 16px;
  }
  .scores-course-table.ant-table .ant-table-thead > tr > th,
  .scores-course-table.ant-table .ant-table-tbody > tr > td,
  .scores-department-table.ant-table .ant-table-thead > tr > th,
  .scores-department-table.ant-table .ant-table-tbody > tr > td {
    text-align: center;
  }
  .scores-course-table.ant-table .ant-table-thead > tr > th:first-child,
  .scores-course-table.ant-table .ant-table-tbody > tr > td:first-child,
  .scores-department-table.ant-table .ant-table-thead > tr > th:first-child,
  .scores-department-table.ant-table .ant-table-tbody > tr > td:first-child {
    text-align: left;
  }
  .lms-page .ant-table-thead > tr > th {
    text-align: center;
  }
  .lms-page .ant-table-tbody > tr > td {
    text-align: center;
  }
  .lms-page .ant-table-thead > tr > th:first-child,
  .lms-page .ant-table-tbody > tr > td:first-child {
    text-align: left;
  }
  @media (max-width: 768px) {
    .lms-page .ant-table-wrapper,
    .scores-table-wrapper {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    .scores-table-wrapper .ant-table {
      min-width: 720px;
    }
  }
  .lms-page .ant-tabs-nav {
    flex-wrap: wrap;
  }
  @media (max-width: 640px) {
    .lms-page .ant-tabs-nav-list { margin-bottom: 0; }
  }

  /* Employee Live Sessions – card-based expandable layout; header and row share same padding for column alignment */
  .session-cards-wrapper {
    padding: 16px 0;
    font-family: var(--lms-font-sans);
    width: 100%;
    overflow-x: auto;
  }
  .session-cards-column-header {
    padding: 16px 20px;
    margin-bottom: 0;
    background: hsl(var(--muted) / 0.6);
    border-radius: 10px 10px 0 0;
    border: 1px solid hsl(var(--border));
    border-bottom: none;
    font-family: var(--lms-font-sans);
    font-size: var(--lms-text-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: hsl(var(--muted-foreground));
    box-sizing: border-box;
  }
  .session-cards-column-header-label {
    display: block;
    line-height: 1.4;
  }
  .session-card-chevron-placeholder {
    visibility: hidden;
    width: 12px;
    flex-shrink: 0;
  }
  .session-cards-list {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }
  .session-card {
    cursor: pointer;
    transition: box-shadow 0.25s ease, border-color 0.25s ease;
    border-radius: 12px;
    overflow: hidden;
    font-family: var(--lms-font-sans);
  }
  .session-card:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    border-color: hsl(var(--ring)) !important;
  }
  .session-card-expanded {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
  }
  /* Main row height same when collapsed or expanded: consistent card body padding */
  .session-card .ant-card-body {
    box-sizing: border-box;
    padding: 8px 16px;
  }
  .session-card:not(.session-card-expanded) .ant-card-body {
    min-height: 48px;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  .session-card:not(.session-card-expanded) .session-card-header.session-card-header-grid {
    width: 100%;
  }
  /* Unified 8-column layout: TITLE (20%) | TYPE (12%) | SESSION AT (15%) | ASSIGNED AT (12%) | DURATION (10%) | HOSTED BY (12%) | STATUS (10%) | ACTION (9%) – full width, 16px column gap */
  .session-card-header-grid {
    display: grid;
    grid-template-columns: 20fr 12fr 15fr 12fr 10fr 12fr 10fr 9fr;
    align-items: center;
    gap: 8px 16px;
    box-sizing: border-box;
    width: 100%;
  }
  .session-cards-column-header.session-card-header-grid {
    padding-left: 20px;
    padding-right: 20px;
  }
  .session-card-header-cell {
    min-width: 0;
    font-size: 13px;
    line-height: var(--lms-leading);
    color: hsl(var(--foreground));
    box-sizing: border-box;
    padding: 12px 16px;
  }
  .session-cards-column-header .session-card-header-cell {
    font-size: 14px;
    text-align: center;
  }
  .session-cards-column-header .session-card-header-cell:first-child,
  .session-card-header-title {
    text-align: left;
  }
  .session-card-header-title {
    display: flex;
    align-items: center;
    gap: 4px;
    grid-column: 1;
    min-width: 0;
    text-align: left;
  }
  .session-card:not(.session-card-expanded) .session-card-header-cell {
    padding: 8px 12px;
  }
  .session-card:not(.session-card-expanded) .session-card-header-title {
    gap: 4px;
  }
  .session-card-header-type,
  .session-card-header-sessionat,
  .session-card-header-assignedat,
  .session-card-header-duration,
  .session-card-header-host,
  .session-card-header-status,
  .session-card-header-action {
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
  .session-card-header-action {
    flex-direction: row;
  }
  .session-card-chevron {
    color: hsl(var(--muted-foreground));
    font-size: 12px;
    flex-shrink: 0;
  }
  .session-card-title {
    font-size: var(--lms-text-base);
    font-weight: 600;
    color: hsl(var(--foreground));
    margin: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    min-width: 0;
    line-height: var(--lms-leading);
  }
  .session-card-header-type {
    grid-column: 2;
    min-width: 0;
  }
  .session-card-header-sessionat {
    grid-column: 3;
    color: hsl(var(--muted-foreground));
    font-size: var(--lms-text-sm);
  }
  .session-card-header-assignedat {
    grid-column: 4;
    color: hsl(var(--muted-foreground));
    font-size: var(--lms-text-sm);
  }
  .session-card-header-datetime {
    grid-column: 3;
    color: hsl(var(--muted-foreground));
    font-size: var(--lms-text-sm);
  }
  .session-card-header-duration {
    grid-column: 5;
    color: hsl(var(--muted-foreground));
    font-size: var(--lms-text-sm);
    white-space: nowrap;
  }
  .session-card-header-host {
    grid-column: 6;
    color: hsl(var(--muted-foreground));
    font-weight: 500;
    font-size: var(--lms-text-sm);
  }
  .session-card-header-host .host-icon {
    display: inline;
  }
  .session-card-header-status {
    grid-column: 7;
    font-weight: 500;
    color: hsl(var(--muted-foreground));
    font-size: var(--lms-text-sm);
  }
  .session-card-header-action {
    grid-column: 8;
  }
  /* Responsive date-time cell: desktop single line, tablet 2 lines, mobile no icon */
  .date-time-cell {
    display: inline-flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: 2px 4px;
    white-space: normal;
    line-height: 1.4;
  }
  .date-time-cell .date-icon {
    display: inline;
    flex-shrink: 0;
  }
  .date-time-cell .time-separator {
    display: inline;
  }
  @media (max-width: 1024px) {
    .date-time-cell {
      flex-direction: column;
      align-items: center;
      gap: 2px;
    }
    .date-time-cell .time-separator {
      display: none;
    }
    .date-time-cell .date-text,
    .date-time-cell .time-text {
      display: block;
    }
  }
  @media (max-width: 768px) {
    .date-time-cell .date-icon {
      display: none;
    }
    .session-card-header-host .host-icon {
      display: none;
    }
    .session-card-header-action .ant-space {
      flex-direction: column;
      align-items: center;
    }
  }
  @media (max-width: 480px) {
    .date-time-cell {
      font-size: 12px;
    }
  }
  .session-card-header-action .ant-space-item > .ant-btn {
    margin-right: 8px;
  }
  .session-card-header-action .ant-space-item:last-child > .ant-btn {
    margin-right: 0;
  }
  .assessment-action-buttons.ant-space .ant-space-item:not(:last-child) {
    margin-right: 8px;
  }
  .session-card-status-live {
    animation: session-pulse 1.5s ease-in-out infinite;
    color: hsl(var(--success)) !important;
  }
  @keyframes session-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.85; }
  }
  .session-card-type-tag {
    margin: 0;
    font-size: var(--lms-text-xs);
  }
  /* Medium-wide: keep columns compact so Session Title doesn’t sit far from Type */
  @media (min-width: 769px) and (max-width: 1024px) {
    .session-card-header-grid {
      grid-template-columns: 20fr 12fr 15fr 12fr 10fr 12fr 10fr 9fr;
      gap: 8px 12px;
    }
    .session-cards-column-header.session-card-header-grid {
      padding-left: 16px;
      padding-right: 16px;
    }
    .session-card .ant-card-body {
      padding: 8px 16px;
    }
    .session-card-body {
      padding: 6px 16px 10px;
    }
  }
  .session-expanded-inner .session-card-divider {
    margin: 8px 0 !important;
  }
  @media (min-width: 1025px) and (max-width: 1360px) {
    .session-card-header-grid {
      gap: 8px 12px;
    }
  }
  /* Expand/collapse animation: grid 0fr → 1fr with transition */
  .session-card-body-wrapper {
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows 0.3s ease-out;
    overflow: hidden;
  }
  .session-card-body-wrapper.session-card-body-expanded {
    grid-template-rows: 1fr;
  }
  .session-card-body {
    margin-top: 0;
    min-height: 0;
    overflow: hidden;
    padding: 8px 20px 12px;
    font-size: var(--lms-text-sm);
    line-height: var(--lms-leading);
  }
  .session-card-body-expanded .session-card-body {
    animation: session-slideDown 0.25s ease-out;
  }
  .session-card-actions .ant-btn {
    font-family: var(--lms-font-sans);
  }
  @keyframes session-slideDown {
    from {
      opacity: 0;
      transform: translateY(-8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .session-card-divider {
    margin: 12px 0 !important;
  }
  /* Expanded toolbar: single row — left: info + platform + agenda + participants; right: Start/Cancel (or other action) buttons */
  .session-expanded-toolbar {
    margin-bottom: 8px;
  }
  .session-expanded-single-row {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    gap: 12px 16px;
  }
  .session-expanded-left {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
    min-width: 0;
  }
  .session-expanded-info {
    flex-shrink: 0;
    line-height: 1.4;
  }
  .session-expanded-right {
    display: flex;
    align-items: center;
    flex-shrink: 0;
  }
  .session-btn-join {
    background: hsl(var(--success)) !important;
    border-color: hsl(var(--success)) !important;
  }
  .session-btn-join:hover {
    background: hsl(var(--success) / 0.9) !important;
    border-color: hsl(var(--success)) !important;
    opacity: 0.95;
  }
  @media (max-width: 1024px) {
    .session-cards-column-header {
      display: none;
    }
    .session-card-header-grid {
      grid-template-columns: 1fr 1fr;
      grid-template-areas:
        "title action"
        "type sessionat"
        "assignedat duration"
        "host status";
      gap: 10px 12px;
    }
    .session-card-header-title { grid-area: title; }
    .session-card-header-type { grid-area: type; }
    .session-card-header-sessionat { grid-area: sessionat; }
    .session-card-header-assignedat { grid-area: assignedat; }
    .session-card-header-datetime { grid-area: sessionat; }
    .session-card-header-duration { grid-area: duration; }
    .session-card-header-host { grid-area: host; }
    .session-card-header-status { grid-area: status; text-align: left; }
    .session-card-header-action { grid-area: action; }
    .session-card-title { white-space: normal; word-break: break-word; }
  }
  @media (max-width: 640px) {
    .session-card-header-grid {
      grid-template-columns: 1fr;
      grid-template-areas:
        "title"
        "type"
        "sessionat"
        "assignedat"
        "duration"
        "host"
        "status"
        "action";
    }
    .session-card-header-datetime { grid-area: sessionat; }
    .session-card .ant-card-body { padding: 8px 16px; }
    .session-card-body { padding: 6px 16px 10px; }
    .session-card-actions .ant-btn { min-height: 44px; min-width: 44px; }
  }
  /* Stacked layout: show label above value when column header is hidden */
  @media (max-width: 1024px) {
    .session-card-header-cell[data-label]::before {
      content: attr(data-label);
      display: block;
      font-size: var(--lms-text-xs);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: hsl(var(--muted-foreground));
      margin-bottom: 2px;
    }
  }

  /* Live Sessions & Assessment use same 8-col grid above; no extra overrides */

  /* Legacy: Employee Live Sessions – unified list container (collapse) */
  .session-list-collapse.ant-collapse-ghost > .ant-collapse-item {
    margin-bottom: 0 !important;
  }
  .session-list-collapse .ant-collapse-header {
    padding: 0 12px 0 40px !important;
    align-items: center !important;
  }
  .session-list-collapse .ant-collapse-content-box {
    padding-left: 12px !important;
    padding-right: 12px !important;
  }
}